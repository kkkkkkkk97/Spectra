# TLS Security Property Testing Configuration

# TLS Implementation Configurations
implementations:
  openssl:
    name: "OpenSSL"
    version: "3.4.0"
    host: "127.0.0.1"
    port: 8411
    docker_container: "impl-openssl"
    enabled: true

  gnutls-3.6:
    name: "GnuTLS"
    version: "3.6.15"
    host: "127.0.0.1"
    port: 8401
    docker_container: "impl-gnutls-3.6"
    enabled: true

  gnutls-3.8:
    name: "GnuTLS"
    version: "3.8.1"
    host: "127.0.0.1"
    port: 8402
    docker_container: "impl-gnutls-3.8"
    enabled: true

  wolfssl-5.2.0:
    name: "WolfSSL"
    version: "5.2.0"
    host: "127.0.0.1"
    port: 8421
    docker_container: "impl-wolfssl-5.2.0"
    enabled: true

  wolfssl-5.6.0:
    name: "WolfSSL"
    version: "5.6.0"
    host: "127.0.0.1"
    port: 8422
    docker_container: "impl-wolfssl-5.6.0"
    enabled: true

  wolfssl-5.8.4:
    name: "WolfSSL"
    version: "5.8.4"
    host: "127.0.0.1"
    port: 8423
    docker_container: "impl-wolfssl-5.8.4"
    enabled: true

  mbedtls:
    name: "mbedTLS"
    version: "3.6.0"
    host: "127.0.0.1"
    port: 8431
    docker_container: "impl-mbedtls"
    enabled: true

  openhitls:
    name: "OpenHiTLS"
    version: "main"
    host: "127.0.0.1"
    port: 8441
    docker_container: "impl-openhitls"
    enabled: true

# Local TLS Implementation Configurations (shell scripts)
local_implementations:
  openssl-1.1.1m-local:
    name: "OpenSSL"
    version: "1.1.1m"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_openssl_1.1.1m.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/key"
    enabled: true

  openssl-3.4.0-local:
    name: "OpenSSL"
    version: "3.4.0"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_openssl_3.4.0.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/key"
    enabled: true

  mbedtls-3.2.1-local:
    name: "mbedTLS"
    version: "3.2.1"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_mbedtls-3.2.1.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/key"
    enabled: true

  mbedtls-3.6.0-local:
    name: "mbedTLS"
    version: "3.6.0"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_mbedtls-3.6.0.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/key"
    enabled: true

  mbedtls-3.6.1-local:
    name: "mbedTLS"
    version: "3.6.1"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_mbedtls-3.6.1.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/key"
    enabled: true

  wolfssl-5.6.0-local:
    name: "WolfSSL"
    version: "5.6.0"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_wolfssl_5.6.0.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/certs"
    enabled: true

  wolfssl-5.8.2-local:
    name: "WolfSSL"
    version: "5.8.2"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_wolfssl_5.8.2.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/certs"
    enabled: true

  openhitls-main-local:
    name: "OpenHiTLS"
    version: "main"
    target_type: "local"
    host: "127.0.0.1"
    port: 4433
    script_path: "/home/kai/Desktop/impl/ssl_server/run_openhitls.sh"
    cert_dir: "/home/kai/Desktop/impl/ssl_server/key"
    enabled: true

# Certificate and Key Paths
certificates:
  # Docker certificates for client-mode tests (connecting to Docker servers)
  docker_certs_dir: "/home/kai/Desktop/impl/certs"

  # Local certificates for server-mode tests (running local server)
  local_certs_dir: "/home/kai/Desktop/tls_infer_new/TLSMapper/key"

  # For client-mode tests (testing servers)
  client:
    cert: "client.crt"
    key: "client.key"
    ca: "ca.crt"

  # For server-mode tests (testing clients)
  server:
    cert: "server.cer"
    key: "deserver.key"
    ca: "ca.crt"

# TLS Protocol Settings
tls:
  version: [3, 4]  # TLS 1.3
  cipher_suites:
    - TLS_AES_128_GCM_SHA256
    - TLS_AES_256_GCM_SHA384
    - TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
    - TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256
    - TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  timeout: 5  # seconds

# Test Execution Settings
test_execution:
  continue_on_error: true
  default_timeout: 30  # seconds per test
  retry_count: 0
  parallel_tests: 1  # Sequential by default

# Property Test Mappings
properties:
  # Client-mode tests (test servers with malicious client)
  client_tests:
    C1:
      name: "Initial message must be ClientHello"
      description: "Send non-ClientHello messages as first message"
    C4:
      name: "HRR must be followed by ClientHello"
      description: "Send other messages after HRR instead of ClientHello"
    C11:
      name: "CCert must be immediately followed by CCV"
      description: "Insert other messages between Certificate and CertificateVerify"
    C12:
      name: "CCV must be immediately followed by CF"
      description: "Insert other messages between CertificateVerify and Finished"
    C13:
      name: "If CRq sent, must have CCert"
      description: "Skip Certificate when CertificateRequest received"
    C16:
      name: "Application data must be after Finished"
      description: "Send ApplicationData before Finished"
    C17:
      name: "ClientHello.legacy_version must be 0x0303"
      description: "Send ClientHello with incorrect legacy_version"
    C18:
      name: "ClientHello.KeyShareY must be in valid range"
      description: "Send ClientHello with invalid KeyShare value"
    C19:
      name: "ClientHello.compression_methods must be [0]"
      description: "Send ClientHello with non-null compression"

  # Server-mode tests (test clients with malicious server)
  server_tests:
    C2:
      name: "Server responds with SH or HRR to CH"
      description: "Send other messages instead of ServerHello/HRR"
    C3:
      name: "HRR can only appear once"
      description: "Send HRR twice in handshake"
    C5:
      name: "ServerHello must be immediately followed by EE"
      description: "Send other messages after ServerHello"
    C6:
      name: "EE must be immediately followed by CRq or SCert"
      description: "Send invalid message after EncryptedExtensions"
    C7:
      name: "CRq must be immediately followed by SCert"
      description: "Send other messages after CertificateRequest"
    C8:
      name: "SCert must be immediately followed by SCV"
      description: "Send Finished directly after Certificate"
    C9:
      name: "SCV must be immediately followed by SF"
      description: "Send other messages after CertificateVerify"
    C10:
      name: "CRq cannot appear before EE"
      description: "Send CertificateRequest before EncryptedExtensions"

# Report Settings
reporting:
  html_template: "templates/report_template.html"
  json_indent: 2
  include_timestamps: true
  include_implementation_details: true
